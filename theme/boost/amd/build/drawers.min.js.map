{"version":3,"sources":["../src/drawers.js"],"names":["backdropPromise","drawerMap","Map","sizes","medium","large","getCurrentWidth","DomRect","document","body","getBoundingClientRect","x","width","isSmall","browserWidth","isMedium","isLarge","getBackdrop","Templates","render","then","html","ModalBackdrop","modalBackdrop","getAttachmentPoint","get","addEventListener","e","preventDefault","Drawers","closeAllDrawers","catch","drawerNode","classList","contains","openDrawer","Aria","hide","set","name","cancelable","eventTypes","drawerInstance","showEvent","dispatchEvent","defaultPrevented","unhide","add","preference","dataset","M","util","set_user_preference","state","page","getElementById","backdrop","show","pageWrapper","style","overflow","closeButton","querySelector","focus","hideEvent","remove","closeDrawer","parseInt","closeOnResize","has","forEach","comparisonInstance","drawerShow","drawerShown","drawerHide","drawerHidden","setLastUsedToggle","toggleButton","target","querySelectorAll","btn","lastused","focusLastUsedToggle","lastUsedButton","scroller","drawerLayout","scrollTop","window","innerHeight","registerListeners","closest","targetDrawer","getDrawerInstanceForNode","toggleVisibility","openDrawerButton","closeDrawerButton","closeOtherDrawers","detail","closeOnResizeListener","anyOpen","isOpen","drawers"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Toggling the visibility of the secondary navigation on mobile.\n *\n * @module     theme_boost/drawers\n * @copyright  2021 Bas Brands\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport ModalBackdrop from 'core/modal_backdrop';\nimport Templates from 'core/templates';\nimport * as Aria from 'core/aria';\nimport {dispatchEvent} from 'core/event_dispatcher';\nimport {debounce} from 'core/utils';\n\nlet backdropPromise = null;\n\nconst drawerMap = new Map();\n\n/**\n * Maximum sizes for breakpoints. This needs to correspond with Bootstrap\n * Breakpoints\n *\n * @private\n */\nconst sizes = {\n    medium: 991,\n    large: 1400\n};\n\nconst getCurrentWidth = () => {\n    const DomRect = document.body.getBoundingClientRect();\n    return DomRect.x + DomRect.width;\n};\n\n/**\n * Check if the user uses a small size browser.\n *\n * @returns {Bool} true if the body is smaller than sizes.medium max size.\n * @private\n */\nconst isSmall = () => {\n    const browserWidth = getCurrentWidth();\n    return browserWidth < sizes.medium;\n};\n\n/**\n * Check if the user uses a medium size browser.\n *\n * @returns {Bool} true if the body is smaller than sizes.medium max size.\n * @private\n */\nconst isMedium = () => {\n    const browserWidth = getCurrentWidth();\n    return (browserWidth >= sizes.medium) && (browserWidth < sizes.large);\n};\n\n/**\n * Check if the user uses a large size browser.\n *\n * @returns {Bool} true if the body is smaller than sizes.large max size.\n * @private\n */\nconst isLarge = () => {\n    const browserWidth = getCurrentWidth();\n    return browserWidth >= sizes.large;\n};\n\n/**\n * Add a backdrop to the page.\n *\n * @returns {Promise} rendering of modal backdrop.\n * @private\n */\nconst getBackdrop = () => {\n    if (!backdropPromise) {\n        backdropPromise = Templates.render('core/modal_backdrop', {})\n        .then(html => new ModalBackdrop(html))\n        .then(modalBackdrop => {\n            modalBackdrop.getAttachmentPoint().get(0).addEventListener('click', e => {\n                e.preventDefault();\n                Drawers.closeAllDrawers();\n            });\n            return modalBackdrop;\n        })\n        .catch();\n    }\n    return backdropPromise;\n};\n\n/**\n * The Drawers class is used to control on-screen drawer elements.\n *\n * It handles opening, and closing of drawer elements, as well as more detailed behaviours such as closing a drawer when\n * another drawer is opened, and supports closing a drawer when the screen is resized.\n *\n * Drawers are instantiated on page load, and can also be toggled lazily when toggling any drawer toggle, open button,\n * or close button.\n *\n * A range of show and hide events are also dispatched as detailed in the class\n * {@link module:theme_boost/drawers#eventTypes eventTypes} object.\n *\n * @example <caption>Standard usage</caption>\n *\n * // The module just needs to be included to add drawer support.\n * import 'theme_boost/drawers';\n *\n * @example <caption>Manually open or close any drawer</caption>\n *\n * import Drawers from 'theme_boost/drawers';\n *\n * const myDrawer = Drawers.getDrawerInstanceForNode(document.querySelector('.myDrawerNode');\n * myDrawer.closeDrawer();\n *\n * @example <caption>Listen to the before show event and cancel it</caption>\n *\n * import Drawers from 'theme_boost/drawers';\n *\n * document.addEventListener(Drawers.eventTypes.drawerShow, e => {\n *     // The drawer which will be shown.\n *     window.console.log(e.target);\n *\n *     // The instance of the Drawers class for this drawer.\n *     window.console.log(e.detail.drawerInstance);\n *\n *     // Prevent this drawer from being shown.\n *     e.preventDefault();\n * });\n *\n * @example <caption>Listen to the shown event</caption>\n *\n * document.addEventListener(Drawers.eventTypes.drawerShown, e => {\n *     // The drawer which was shown.\n *     window.console.log(e.target);\n *\n *     // The instance of the Drawers class for this drawer.\n *     window.console.log(e.detail.drawerInstance);\n * });\n */\nexport default class Drawers {\n    /**\n     * The underlying HTMLElement which is controlled.\n     */\n    drawerNode = null;\n\n    constructor(drawerNode) {\n        this.drawerNode = drawerNode;\n\n        if (this.drawerNode.classList.contains('show')) {\n            this.openDrawer();\n        } else {\n            Aria.hide(this.drawerNode);\n        }\n\n        drawerMap.set(drawerNode, this);\n    }\n\n    /**\n     * Whether the drawer is open.\n     *\n     * @returns {bool}\n     */\n    get isOpen() {\n        return this.drawerNode.classList.contains('show');\n    }\n\n    /**\n     * Whether the drawer should close when the window is resized\n     *\n     * @returns {bool}\n     */\n    get closeOnResize() {\n        return !!parseInt(this.drawerNode.dataset.closeOnResize);\n    }\n\n    /**\n     * The list of event types.\n     *\n     * @static\n     * @property {String} drawerShow See {@link event:theme_boost/drawers:show}\n     * @property {String} drawerShown See {@link event:theme_boost/drawers:shown}\n     * @property {String} drawerHide See {@link event:theme_boost/drawers:hide}\n     * @property {String} drawerHidden See {@link event:theme_boost/drawers:hidden}\n     */\n    static eventTypes = {\n        /**\n         * An event triggered before a drawer is shown.\n         *\n         * @event theme_boost/drawers:show\n         * @type {CustomEvent}\n         * @property {HTMLElement} target The drawer that will be opened.\n         */\n        drawerShow: 'theme_boost/drawers.show',\n\n        /**\n         * An event triggered after a drawer is shown.\n         *\n         * @event theme_boost/drawers:shown\n         * @type {CustomEvent}\n         * @property {HTMLElement} target The drawer that was be opened.\n         */\n        drawerShown: 'theme_boost/drawers:shown',\n\n        /**\n         * An event triggered before a drawer is hidden.\n         *\n         * @event theme_boost/drawers:hide\n         * @type {CustomEvent}\n         * @property {HTMLElement} target The drawer that will be hidden.\n         */\n        drawerHide: 'theme_boost/drawers:hide',\n\n        /**\n         * An event triggered after a drawer is hidden.\n         *\n         * @event theme_boost/drawers:hidden\n         * @type {CustomEvent}\n         * @property {HTMLElement} target The drawer that was be hidden.\n         */\n        drawerHidden: 'theme_boost/drawers:hidden',\n    };\n\n\n    /**\n     * Get the drawer instance for the specified node\n     *\n     * @param {NodeElement} drawerNode\n     * @returns {module:theme_boost/drawers}\n     */\n    static getDrawerInstanceForNode(drawerNode) {\n        if (!drawerMap.has(drawerNode)) {\n            new Drawers(drawerNode);\n        }\n\n        return drawerMap.get(drawerNode);\n    }\n\n    dispatchEvent(name, cancelable = false) {\n        return dispatchEvent(\n            Drawers.eventTypes[name],\n            {\n                drawerInstance: this,\n            },\n            this.drawerNode,\n            {\n                cancelable,\n            }\n        );\n    }\n\n    /**\n     * Open the drawer.\n     */\n    openDrawer() {\n        const showEvent = this.dispatchEvent('drawerShow', true);\n        if (showEvent.defaultPrevented) {\n            return;\n        }\n\n        Aria.unhide(this.drawerNode);\n        this.drawerNode.classList.add('show');\n\n        const preference = this.drawerNode.dataset.preference;\n        if (!isMedium() && preference) {\n            M.util.set_user_preference(preference, true);\n        }\n\n        const state = this.drawerNode.dataset.state;\n        if (state) {\n            const page = document.getElementById('page');\n            page.classList.add(state);\n        }\n\n        if (isSmall()) {\n            getBackdrop().then(backdrop => {\n                backdrop.show();\n\n                // TODO\n                const pageWrapper = document.getElementById('page-wrapper');\n                pageWrapper.style.overflow = 'hidden';\n                return backdrop;\n            })\n            .catch();\n        }\n\n        const closeButton = this.drawerNode.querySelector('[data-toggle=\"drawers\"][data-action=\"closedrawer\"]');\n        closeButton.focus();\n\n        this.dispatchEvent('drawerShown');\n    }\n\n    /**\n     * Close the drawer.\n     */\n    closeDrawer() {\n        const hideEvent = this.dispatchEvent('drawerHide', true);\n        if (hideEvent.defaultPrevented) {\n            return;\n        }\n\n        const preference = this.drawerNode.dataset.preference;\n        if (!isMedium() && preference) {\n            M.util.set_user_preference(preference, false);\n        }\n\n        const state = this.drawerNode.dataset.state;\n        if (state) {\n            const page = document.getElementById('page');\n            page.classList.remove(state);\n        }\n\n        Aria.hide(this.drawerNode);\n        this.drawerNode.classList.remove('show');\n\n        getBackdrop().then(backdrop => {\n            backdrop.hide();\n\n            if (isMedium()) {\n                const pageWrapper = document.getElementById('page-wrapper');\n                pageWrapper.style.overflow = 'auto';\n            }\n            return backdrop;\n        })\n        .catch();\n\n        this.dispatchEvent('drawerHidden');\n    }\n\n    /**\n     * Toggle visibility of the drawer.\n     */\n    toggleVisibility() {\n        if (this.drawerNode.classList.contains('show')) {\n            this.closeDrawer();\n        } else {\n            this.openDrawer();\n        }\n    }\n\n    /**\n     * Close all drawers.\n     */\n    static closeAllDrawers() {\n        drawerMap.forEach(drawerInstance => {\n            drawerInstance.closeDrawer();\n        });\n    }\n\n    /**\n     * Close all drawers except for the specified drawer.\n     *\n     * @param {module:theme_boost/drawers} comparisonInstance\n     */\n    static closeOtherDrawers(comparisonInstance) {\n        drawerMap.forEach(drawerInstance => {\n            if (drawerInstance === comparisonInstance) {\n                return;\n            }\n\n            drawerInstance.closeDrawer();\n        });\n    }\n}\n\n/**\n * Activate the scroller helper for the drawer layout.\n *\n * @private\n */\nconst scroller = () => {\n    const body = document.querySelector('body');\n    const drawerLayout = document.querySelector('#page.drawers');\n    drawerLayout.addEventListener(\"scroll\", () => {\n        if (drawerLayout.scrollTop >= window.innerHeight) {\n            body.classList.add('scrolled');\n        } else {\n            body.classList.remove('scrolled');\n        }\n    });\n};\n\n/**\n * Set the last used attribute for the last used toggle button for a drawer.\n *\n * @param {object} toggleButton The clicked button.\n */\nconst setLastUsedToggle = (toggleButton) => {\n    if (toggleButton.dataset.target) {\n        document.querySelectorAll('[data-toggle=\"drawers\"][data-target=\"' + toggleButton.dataset.target + '\"]')\n        .forEach(btn => {\n            btn.dataset.lastused = false;\n        });\n        toggleButton.dataset.lastused = true;\n    }\n};\n\n/**\n * Set the focus to the last used button to open this drawer.\n * @param {string} target The drawer target.\n */\nconst focusLastUsedToggle = (target) => {\n    const lastUsedButton = document.querySelector('[data-toggle=\"drawers\"][data-target=\"' + target + '\"][data-lastused=\"true\"');\n    if (lastUsedButton) {\n        lastUsedButton.focus();\n    }\n};\n\n/**\n * Register the event listeners for the drawer.\n *\n * @private\n */\nconst registerListeners = () => {\n    // Listen for show/hide events.\n    document.addEventListener('click', e => {\n        const toggleButton = e.target.closest('[data-toggle=\"drawers\"][data-action=\"toggle\"]');\n        if (toggleButton && toggleButton.dataset.target) {\n            e.preventDefault();\n            const targetDrawer = document.getElementById(toggleButton.dataset.target);\n            const drawerInstance = Drawers.getDrawerInstanceForNode(targetDrawer);\n            setLastUsedToggle(toggleButton);\n\n            drawerInstance.toggleVisibility();\n        }\n\n        const openDrawerButton = e.target.closest('[data-toggle=\"drawers\"][data-action=\"opendrawer\"]');\n        if (openDrawerButton && openDrawerButton.dataset.target) {\n            e.preventDefault();\n            const targetDrawer = document.getElementById(openDrawerButton.dataset.target);\n            const drawerInstance = Drawers.getDrawerInstanceForNode(targetDrawer);\n            setLastUsedToggle(toggleButton);\n\n            drawerInstance.openDrawer();\n        }\n\n        const closeDrawerButton = e.target.closest('[data-toggle=\"drawers\"][data-action=\"closedrawer\"]');\n        if (closeDrawerButton && closeDrawerButton.dataset.target) {\n            e.preventDefault();\n            const targetDrawer = document.getElementById(closeDrawerButton.dataset.target);\n            const drawerInstance = Drawers.getDrawerInstanceForNode(targetDrawer);\n\n            drawerInstance.closeDrawer();\n            focusLastUsedToggle(closeDrawerButton.dataset.target);\n        }\n    });\n\n    // Close drawer when another drawer opens.\n    document.addEventListener(Drawers.eventTypes.drawerShow, e => {\n        if (isLarge()) {\n            return;\n        }\n        Drawers.closeOtherDrawers(e.detail.drawerInstance);\n    });\n\n    const closeOnResizeListener = () => {\n        if (isSmall()) {\n            let anyOpen = false;\n            drawerMap.forEach(drawerInstance => {\n                if (drawerInstance.isOpen) {\n                    if (drawerInstance.closeOnResize) {\n                        drawerInstance.closeDrawer();\n                    } else {\n                        anyOpen = true;\n                    }\n                }\n            });\n\n            if (anyOpen) {\n                getBackdrop().then(backdrop => backdrop.show()).catch();\n            }\n        } else {\n            getBackdrop().then(backdrop => backdrop.hide()).catch();\n        }\n    };\n\n    window.addEventListener('resize', debounce(closeOnResizeListener, 400));\n};\n\nscroller();\nregisterListeners();\n\nconst drawers = document.querySelectorAll('[data-region=\"fixed-drawer\"]');\ndrawers.forEach(drawerNode => Drawers.getDrawerInstanceForNode(drawerNode));\n"],"file":"drawers.min.js"}